{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Drug Response 23andMe","text":"<p>Drug Response 23andMe is a Python package for annotating 23andMe raw genotype data with drug response information from the PharmGKB database. It automates the parsing of genotype files, integrates variant annotations, and identifies significant efficacy variants relevant to the user.</p> <p>Scope &amp; Limitations</p> <ul> <li>Input Data: Designed for 23andMe raw data (v5) text files.</li> <li>Annotation Source: Uses PharmGKB variant annotations (<code>var_drug_ann.tsv</code>).</li> <li>Focus: Primarily filters for Significant Efficacy variants to provide actionable insights.</li> </ul> <p>This tool is designed for bioinformatics students and researchers who want to explore pharmacogenomics using personal genetic data.</p>"},{"location":"#installation","title":"Installation","text":"<p>You can install <code>drug_response_23andme</code> directly from GitHub using <code>pip</code>.</p>"},{"location":"#option-1-install-from-github-recommended","title":"Option 1: Install from GitHub (Recommended)","text":"<p>To install the latest version of the package:</p> <pre><code>pip install git+https://github.com/GSYH/drug_response_23andme.git\n</code></pre>"},{"location":"#option-2-clone-and-install","title":"Option 2: Clone and Install","text":"<pre><code>git clone https://github.com/GSYH/drug_response_23andme.git\ncd drug_response_23andme\npip install .\n</code></pre>"},{"location":"#features","title":"Features","text":"<ul> <li>Load 23andMe Data: Easily parse your raw 23andMe text file.</li> <li>Load PharmGKB Data: Import variant annotations from PharmGKB.</li> <li>Merge &amp; Filter: Combine datasets to find significant efficacy variants relevant to your genotype.</li> <li>Visualize: Generate plots showing the distribution of drugs and SNPs per gene.</li> </ul>"},{"location":"api/","title":"API Reference","text":""},{"location":"api/#loader-module","title":"Loader Module","text":""},{"location":"api/#drug_response_23andme.loader.load_23andme","title":"<code>load_23andme(file_path)</code>","text":"<p>Loads and cleans 23andMe raw data file.</p> <p>Parameters:</p> Name Type Description Default <code>file_path</code> <code>str</code> <p>Path to the 23andMe txt file.</p> required <p>Returns:</p> Type Description <p>pd.DataFrame: Cleaned DataFrame with columns [CHR, POS, dbSNP_ID, ALLELE_23andme]</p> Source code in <code>drug_response_23andme/loader.py</code> <pre><code>def load_23andme(file_path):\n    \"\"\"\n    Loads and cleans 23andMe raw data file.\n\n    Args:\n        file_path (str): Path to the 23andMe txt file.\n\n    Returns:\n        pd.DataFrame: Cleaned DataFrame with columns [CHR, POS, dbSNP_ID, ALLELE_23andme]\n    \"\"\"\n    # Read file, skipping comments\n    df = pd.read_csv(\n        file_path,\n        sep=\"\\t\",\n        comment='#',\n        header=None,\n        names=[\"CHR\", \"POS\", \"dbSNP_ID\", \"ALLELE_23andme\"],\n        dtype=str\n    )\n\n    # Drop rows missing rsIDs (some entries have i###### codes)\n    df = df[df[\"dbSNP_ID\"].str.startswith(\"rs\", na=False)].copy()\n\n    return df\n</code></pre>"},{"location":"api/#drug_response_23andme.loader.load_pharmgkb","title":"<code>load_pharmgkb(file_path)</code>","text":"<p>Loads and cleans PharmGKB variant annotation file.</p> <p>Parameters:</p> Name Type Description Default <code>file_path</code> <code>str</code> <p>Path to the PharmGKB tsv file.</p> required <p>Returns:</p> Type Description <p>pd.DataFrame: Cleaned DataFrame with standardized columns.</p> Source code in <code>drug_response_23andme/loader.py</code> <pre><code>def load_pharmgkb(file_path):\n    \"\"\"\n    Loads and cleans PharmGKB variant annotation file.\n\n    Args:\n        file_path (str): Path to the PharmGKB tsv file.\n\n    Returns:\n        pd.DataFrame: Cleaned DataFrame with standardized columns.\n    \"\"\"\n    # Skip the single bad line containing \u201cThe 15-year cumulative\u201d if it exists\n    # This is specific to the user's notebook logic\n    lines_clean = []\n    with open(file_path, \"r\", encoding=\"utf-8\", errors=\"replace\") as f:\n        for line in f:\n            if \"The 15-year cumulative\" in line:\n                continue\n            lines_clean.append(line)\n\n    df = pd.read_csv(StringIO(\"\".join(lines_clean)), sep=\"\\t\", dtype=str, low_memory=False)\n\n    # Select &amp; rename relevant columns\n    col_map = {\n        \"Variant/Haplotypes\": \"dbSNP_ID\",\n        \"Gene\": \"GENE_SYMBOL\",\n        \"Drug(s)\": \"DRUG_NAME\",\n        \"PMID\": \"PMID\",\n        \"Phenotype Category\": \"PHENOTYPE_CATEGORY\",\n        \"Significance\": \"SIGNIFICANCE\",\n        \"Notes\": \"NOTES\",\n        \"Sentence\": \"SENTENCE\",\n        \"Alleles\": \"ALLELE_PharmGKB\",\n    }\n\n    # Check if columns exist before selecting\n    available_cols = [c for c in col_map.keys() if c in df.columns]\n    df = df[available_cols].rename(columns=col_map)\n\n    # Keep only rows with valid rsIDs\n    if \"dbSNP_ID\" in df.columns:\n        df = df[df[\"dbSNP_ID\"].str.fullmatch(r\"rs\\d+\", na=False)].copy()\n\n    return df\n</code></pre>"},{"location":"api/#processor-module","title":"Processor Module","text":""},{"location":"api/#drug_response_23andme.processor.filter_significant_efficacy","title":"<code>filter_significant_efficacy(df)</code>","text":"<p>Filters for significant efficacy variants.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Merged DataFrame.</p> required <p>Returns:</p> Type Description <p>pd.DataFrame: Filtered DataFrame.</p> Source code in <code>drug_response_23andme/processor.py</code> <pre><code>def filter_significant_efficacy(df):\n    \"\"\"\n    Filters for significant efficacy variants.\n\n    Args:\n        df (pd.DataFrame): Merged DataFrame.\n\n    Returns:\n        pd.DataFrame: Filtered DataFrame.\n    \"\"\"\n    if \"SIGNIFICANCE\" not in df.columns or \"PHENOTYPE_CATEGORY\" not in df.columns:\n        return df\n\n    df_sig_eff = df[\n        (df[\"SIGNIFICANCE\"].str.lower() == \"yes\") &amp;\n        (df[\"PHENOTYPE_CATEGORY\"].str.lower() == \"efficacy\")\n    ].copy()\n\n    return df_sig_eff\n</code></pre>"},{"location":"api/#drug_response_23andme.processor.merge_data","title":"<code>merge_data(df_23, df_ann)</code>","text":"<p>Merges 23andMe data with PharmGKB annotations on dbSNP_ID.</p> <p>Parameters:</p> Name Type Description Default <code>df_23</code> <code>DataFrame</code> <p>23andMe data.</p> required <code>df_ann</code> <code>DataFrame</code> <p>PharmGKB data.</p> required <p>Returns:</p> Type Description <p>pd.DataFrame: Merged DataFrame.</p> Source code in <code>drug_response_23andme/processor.py</code> <pre><code>def merge_data(df_23, df_ann):\n    \"\"\"\n    Merges 23andMe data with PharmGKB annotations on dbSNP_ID.\n\n    Args:\n        df_23 (pd.DataFrame): 23andMe data.\n        df_ann (pd.DataFrame): PharmGKB data.\n\n    Returns:\n        pd.DataFrame: Merged DataFrame.\n    \"\"\"\n    # Merge with 23andMe\n    df_merge = df_ann.merge(df_23[[\"dbSNP_ID\", \"ALLELE_23andme\"]], on=\"dbSNP_ID\", how=\"inner\")\n\n    # Reorder columns if they exist\n    cols = [\n        \"dbSNP_ID\", \"GENE_SYMBOL\", \"DRUG_NAME\", \"PMID\",\n        \"PHENOTYPE_CATEGORY\", \"SIGNIFICANCE\", \"NOTES\", \"SENTENCE\",\n        \"ALLELE_PharmGKB\", \"ALLELE_23andme\"\n    ]\n    existing_cols = [c for c in cols if c in df_merge.columns]\n\n    return df_merge[existing_cols]\n</code></pre>"},{"location":"api/#drug_response_23andme.processor.summarize_data","title":"<code>summarize_data(df)</code>","text":"<p>Creates a summary of drugs per gene.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Filtered DataFrame.</p> required <p>Returns:</p> Type Description <p>pd.DataFrame: Summary DataFrame with columns [GENE_SYMBOL, DRUG_NAME, dbSNP_IDs]</p> Source code in <code>drug_response_23andme/processor.py</code> <pre><code>def summarize_data(df):\n    \"\"\"\n    Creates a summary of drugs per gene.\n\n    Args:\n        df (pd.DataFrame): Filtered DataFrame.\n\n    Returns:\n        pd.DataFrame: Summary DataFrame with columns [GENE_SYMBOL, DRUG_NAME, dbSNP_IDs]\n    \"\"\"\n    if \"GENE_SYMBOL\" not in df.columns or \"DRUG_NAME\" not in df.columns:\n        return pd.DataFrame()\n\n    summary = (\n        df.groupby([\"GENE_SYMBOL\", \"DRUG_NAME\"])[\"dbSNP_ID\"]\n        .apply(lambda s: \";\".join(sorted(set(s))))\n        .reset_index(name=\"dbSNP_IDs\")\n    )\n    return summary\n</code></pre>"},{"location":"api/#visualizer-module","title":"Visualizer Module","text":""},{"location":"api/#drug_response_23andme.visualizer.plot_stats","title":"<code>plot_stats(df, output_prefix='plot')</code>","text":"<p>Generates histograms for drugs/gene and SNPs/gene.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>The filtered DataFrame.</p> required <code>output_prefix</code> <code>str</code> <p>Prefix for saved plot files.</p> <code>'plot'</code> Source code in <code>drug_response_23andme/visualizer.py</code> <pre><code>def plot_stats(df, output_prefix=\"plot\"):\n    \"\"\"\n    Generates histograms for drugs/gene and SNPs/gene.\n\n    Args:\n        df (pd.DataFrame): The filtered DataFrame.\n        output_prefix (str): Prefix for saved plot files.\n    \"\"\"\n    if df.empty:\n        print(\"No data to plot.\")\n        return\n\n    # 1. Number of drugs per gene\n    if \"GENE_SYMBOL\" in df.columns and \"DRUG_NAME\" in df.columns:\n        drugs_per_gene = df.groupby(\"GENE_SYMBOL\")[\"DRUG_NAME\"].nunique()\n\n        plt.figure(figsize=(6,4))\n        plt.hist(drugs_per_gene, bins=20, color='skyblue', edgecolor='black')\n        plt.xlabel(\"# of drugs associated per gene\")\n        plt.ylabel(\"Number of genes\")\n        plt.title(\"Distribution of drugs per gene\")\n        plt.tight_layout()\n        plt.savefig(f\"{output_prefix}_drugs_per_gene.png\")\n        plt.close()\n        print(f\"Saved {output_prefix}_drugs_per_gene.png\")\n\n    # 2. Number of SNPs per gene\n    if \"GENE_SYMBOL\" in df.columns and \"dbSNP_ID\" in df.columns:\n        snps_per_gene = df.groupby(\"GENE_SYMBOL\")[\"dbSNP_ID\"].nunique()\n\n        plt.figure(figsize=(6,4))\n        plt.hist(snps_per_gene, bins=20, color='salmon', edgecolor='black')\n        plt.xlabel(\"# of SNPs per gene\")\n        plt.ylabel(\"Number of genes\")\n        plt.title(\"Distribution of SNPs per gene\")\n        plt.tight_layout()\n        plt.savefig(f\"{output_prefix}_snps_per_gene.png\")\n        plt.close()\n        print(f\"Saved {output_prefix}_snps_per_gene.png\")\n</code></pre>"},{"location":"user_guide/","title":"User Guide","text":""},{"location":"user_guide/#prerequisites","title":"Prerequisites","text":"<p>You need two files: 1.  23andMe Raw Data: A text file containing your genotype data. 2.  PharmGKB Variant Annotations: A TSV file (<code>var_drug_ann.tsv</code>) from PharmGKB.</p>"},{"location":"user_guide/#step-by-step","title":"Step-by-Step","text":"<ol> <li>Load the Data: Use <code>loader.load_23andme()</code> and <code>loader.load_pharmgkb()</code> to read your files into pandas DataFrames.</li> <li>Merge: Use <code>processor.merge_data()</code> to join the two DataFrames on <code>dbSNP_ID</code>. This keeps only the variants present in both files.</li> <li>Filter: Use <code>processor.filter_significant_efficacy()</code> to keep only variants with \"Significant\" evidence and \"Efficacy\" phenotype category.</li> <li>Summarize: Use <code>processor.summarize_data()</code> to get a clean table of genes and drugs.</li> <li>Plot: Use <code>visualizer.plot_stats()</code> to see histograms of your results.</li> </ol>"}]}